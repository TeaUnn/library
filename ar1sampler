# ar1sampler samples from a
# first-order autoregressive model (AR(1))
# with normal noise

ar1sampler <- function(t,       # sample size
                       mu,      # mean of x
                       phi,     # dependency parameter
                       sigma2){ # variance of error term
  x <- mu
  for(i in 2:t){
    x[i] <- mu + phi * (x[i-1] - mu) +
              rnorm(1, 0, sigma2)
  }
  return(x)
}